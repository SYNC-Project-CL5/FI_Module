<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html>
<head>
<title>ZEA_FI100_F01</title>
</head>
<body bgcolor="#FFFFE0">
<font size="3" face = "Arial" color="#000000"><b>Code listing for: ZEA_FI100_F01</b></font>
<br>
<font size="3" face = "Arial" color="#000000"><b>Description:  Include ZEA_TR_TEM_F01</b></font>
<hr>
<pre width="100">
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Include          ZEA_TR_TEM_F01</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form get_data</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM GET_DATA .

  " Internal Table의 내용을 전부 비워둠
  REFRESH GT_DATA[].

<font color ="#0000FF">* --B/S 계정 (자산)</font>
  SELECT

    B~GJAHR   " 회계연도
    B~SAKNR   " G/L계정 (Recon)
    B~BPCODE  "BP CODE
    D~INDI_CD "차대변 구분자
    C~GLTXT   " G/L계정명
    SUM( B~DMBTR ) AS DMBTR "  통화금액 합계
<font color ="#0000FF">*    SUM( B~EATAX ) AS EATAX " 세금 합계</font>
  INTO CORRESPONDING FIELDS OF TABLE GT_DATA
  FROM ZEA_BKPF AS A        " A: 전표 헤더
 INNER JOIN ZEA_BSEG AS B   " B: 전표 아이템
    ON A~BUKRS EQ B~BUKRS
   AND A~BELNR EQ B~BELNR
   AND A~GJAHR EQ B~GJAHR
 INNER JOIN ZEA_SKB1 AS C   " C: G/L계정마스터
    ON C~BUKRS EQ A~BUKRS
   AND C~SAKNR EQ B~SAKNR
<font color ="#0000FF">*   AND C~GLTXT EQ B~GLTXT</font>
   AND C~XBILK EQ 'X'        " G/L코드 Type - 'X': 대차대조 / '' : 손익계산
INNER JOIN ZEA_TBSL AS D     "D : 전기키 테이블
    ON D~BSCHL EQ B~BSCHL
 INNER JOIN ZEA_SKA1 AS E   "E : BP 마스터
    ON B~BPCODE EQ E~BPCODE

  WHERE C~SAKNR IN R_SAKNR_1
  GROUP BY B~GJAHR B~SAKNR B~BPCODE D~INDI_CD C~GLTXT .

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form set_fcat</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM SET_TREE_FCAT .

  GS_LAYOUT-ZEBRA      = 'X'.
  GS_LAYOUT-CWIDTH_OPT = 'A'.
  GS_LAYOUT-SEL_MODE   = 'D'.

<font color ="#0000FF">**  PERFORM SET_FCAT USING :</font>
<font color ="#0000FF">*** 계정과목 추가 필요</font>
<font color ="#0000FF">**  'X'  '계정번호'    ' '   'ZEA_BSEG'     'SAKNR',</font>
<font color ="#0000FF">**  ' '  '계정명'      ' '   'ZEA_BSEG'     'GLTXT',</font>
<font color ="#0000FF">**  ' '  'S/H'         ' '    'ZEA_TBSL'     'INDI_CD',</font>
<font color ="#0000FF">**  ' '  'AMOUNT'      ' '   'ZEA_BSEG'   'DMBTR',</font>
<font color ="#0000FF">**  ' '  'Tax'         ' '   'ZEA_BSEG'   'EATAX',</font>
<font color ="#0000FF">**  ' '  'CURRENCY'    ' '   'ZEA_BSEG'   'D_WAERS',</font>
<font color ="#0000FF">**  ' '  'PLANETYPE'   ' '   'SFLIGHT'   'PLANETYPE'.</font>

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form set_fcat</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM SET_FCAT TABLES PT_FCAT STRUCTURE LVC_S_FCAT
              USING PV_KEY
                    PV_FIELD
                    PV_TEXT
                    PV_REF_TABLE
                    PV_REF_FIELD.

  CLEAR PT_FCAT.
  PT_FCAT-KEY       = PV_KEY.
  PT_FCAT-FIELDNAME = PV_FIELD.
  PT_FCAT-COLTEXT   = PV_TEXT.
  PT_FCAT-REF_TABLE = PV_REF_TABLE.
  PT_FCAT-REF_FIELD = PV_REF_FIELD.

  CASE PV_FIELD.
    WHEN 'T_AMOUNT'.
      PT_FCAT-CFIELDNAME = 'D_WAERS'.

  ENDCASE.

  APPEND PT_FCAT.
  CLEAR  PT_FCAT.

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form create_object</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& --&gt;  p1        text</font>
<font color ="#0000FF">*& &lt;--  p2        text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM CREATE_OBJECT_1.

<font color ="#0000FF">*----- 자산 Container</font>
  CREATE OBJECT GCL_CONTAINER
    EXPORTING
      SIDE  = GCL_CONTAINER-&gt;DOCK_AT_LEFT
<font color ="#0000FF">*     EXTENSION = 1000</font>
      RATIO = 50.

  CREATE OBJECT GCL_TREE
    EXPORTING
      I_PARENT              = GCL_CONTAINER
<font color ="#0000FF">*     I_NODE_SELECTION_MODE = CL_GUI_COLUMN_TREE=&gt;NODE_SEL_MODE_MULTIPLE</font>
      I_NODE_SELECTION_MODE = CL_GUI_COLUMN_TREE=&gt;ALIGN_AT_LEFT
      I_ITEM_SELECTION      = 'X'
      I_NO_HTML_HEADER      = 'X'
      I_NO_TOOLBAR          = SPACE.

  GS_VARIANT-REPORT = SY-REPID.
  GS_VARIANT-HANDLE = '1'.

  CALL METHOD GCL_TREE-&gt;SET_TABLE_FOR_FIRST_DISPLAY
    EXPORTING
      I_SAVE          = 'A'
      IS_LAYOUT       = GS_LAYOUT
      IS_VARIANT      = GS_VARIANT
    CHANGING
      IT_OUTTAB       = GT_DISPLAY1
      IT_SORT         = GT_SORT
      IT_FIELDCATALOG = GT_FCAT.

  CALL METHOD GCL_TREE-&gt;EXPAND_TREE
    EXPORTING
      I_LEVEL = 1.

  CALL METHOD GCL_TREE-&gt;COLUMN_OPTIMIZE
    EXPORTING
      I_START_COLUMN = GCL_TREE-&gt;C_HIERARCHY_COLUMN_NAME
      I_END_COLUMN   = GCL_TREE-&gt;C_HIERARCHY_COLUMN_NAME.


ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form set_sort</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM SET_SORT TABLES PT_SORT STRUCTURE LVC_S_SORT.

  REFRESH PT_SORT.

<font color ="#0000FF">*&---Make Tree of 자산-------------------------------------------------*</font>

  "1. 계정과목 폴더
  GS_SORT-SPOS = 1.             "정렬순서를 지정
  GS_SORT-FIELDNAME = 'FLTXT'.  "자산 폴더
<font color ="#0000FF">* GS_SORT-SELTEXT = '계정과목'.</font>
  GS_SORT-UP        = 'X'.  "오름차순 정렬
  GS_SORT-SUBTOT    = 'X'.    "중간합 구하기

  APPEND GS_SORT TO PT_SORT.
  CLEAR  GS_SORT.

  GS_SORT-SPOS = 2.              "정렬순서를 지정
  GS_SORT-FIELDNAME = 'FLTXT2'.  "유동/비유동 구분
<font color ="#0000FF">* GS_SORT-SELTEXT = '계정과목'.</font>
  GS_SORT-DOWN        = 'X'.  "내림차순 정렬(Ex. 유동, 비유동 순)
<font color ="#0000FF">*  GS_SORT-SUBTOT    = 'X'.    "중간합 구하기</font>

  APPEND GS_SORT TO PT_SORT.
  CLEAR  GS_SORT.
<font color ="#0000FF">*</font>
  "2. 계정번호
  GS_SORT-SPOS = 3.
  GS_SORT-FIELDNAME = 'GLTXT'.  "계정코드
  GS_SORT-UP        = 'X'.
<font color ="#0000FF">*  GS_SORT-SUBTOT    = 'X'.</font>

  APPEND GS_SORT TO PT_SORT.
  CLEAR  GS_SORT.

  "3. 금액
  GS_SORT-SPOS = 3.
  GS_SORT-FIELDNAME = 'SAKNR'.
  GS_SORT-UP        = 'X'.
<font color ="#0000FF">*  GS_SORT-SUBTOT    = 'X'.</font>

  APPEND GS_SORT TO PT_SORT.
  CLEAR  GS_SORT.

  "4. 통화금액
<font color ="#0000FF">*  GS_SORT-SPOS = 3.</font>
<font color ="#0000FF">*  GS_SORT-FIELDNAME = 'T_AMOUNT'.</font>
<font color ="#0000FF">*  GS_SORT-UP        = 'X'.</font>
<font color ="#0000FF">*  GS_SORT-SUBTOT    = 'X'.</font>

<font color ="#0000FF">*  APPEND GS_SORT TO PT_SORT.</font>
<font color ="#0000FF">*  CLEAR  GS_SORT.</font>

  "5. H_AMOUNT
  "6. S_AMOUNT
  "위 필드는 보여주지 않음.
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  "7. D_WAERS</font>
<font color ="#0000FF">*  GS_SORT-SPOS = 3.</font>
<font color ="#0000FF">*  GS_SORT-FIELDNAME = 'D_WAERS'.</font>
<font color ="#0000FF">*  GS_SORT-UP        = 'X'.</font>
<font color ="#0000FF">*  GS_SORT-SUBTOT    = 'X'.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  APPEND GS_SORT TO PT_SORT.</font>
<font color ="#0000FF">*  CLEAR  GS_SORT.</font>


ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form SET_FIELD_CATALOG</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM SET_FIELD_CATALOG  USING    PT_TAB TYPE STANDARD TABLE
                        CHANGING PT_FCAT TYPE LVC_T_FCAT.

  DATA: LO_DREF TYPE REF TO DATA.

  CREATE DATA LO_DREF LIKE PT_TAB.
  FIELD-SYMBOLS &lt;LT_TAB&gt; TYPE TABLE.
  ASSIGN LO_DREF-&gt;* TO &lt;LT_TAB&gt;.

  TRY.
      CALL METHOD CL_SALV_TABLE=&gt;FACTORY
        IMPORTING
          R_SALV_TABLE = DATA(LR_TABLE)
        CHANGING
          T_TABLE      = &lt;LT_TAB&gt;.

    CATCH CX_SALV_MSG. " ALV: General Error Class with Message
  ENDTRY.

  PT_FCAT = CL_SALV_CONTROLLER_METADATA=&gt;GET_LVC_FIELDCATALOG(
              R_COLUMNS      = LR_TABLE-&gt;GET_COLUMNS( )
              R_AGGREGATIONS = LR_TABLE-&gt;GET_AGGREGATIONS( )
            ).


ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form MAKE_FILED_CATALOG</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM MAKE_FILED_CATALOG .

  GS_LAYOUT-ZEBRA      = 'X'.
  GS_LAYOUT-CWIDTH_OPT = 'A'.
  GS_LAYOUT-SEL_MODE   = 'D'.
  GV_SAVE = 'A'.


  REFRESH GT_FCAT.
  PERFORM SET_FCAT
  TABLES GT_FCAT
     USING :

   ' '   'FLTXT'        '계정과목'        ' '         ' ',
   ' '   'FLTXT2'       '유동/비유동'     ' '         ' ',
   ' '   'GLTXT'        '계정명'     'ZEA_SKB1'    'GLTXT',
   ' '   'SAKNR'        'G/L계정'    'ZEA_SKB1'    'SAKNR',
   ' '   'T_AMOUNT'     'Amount'     'ZEA_BSEG'    'DMBTR',
   ' '   'D_WAERS'      '통화코드'   'ZEA_BSEG'    'D_WAERS'.

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form CREATE_OBJECT2</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM CREATE_OBJECT2 .

<font color ="#0000FF">*----- 부채 Container</font>
  CREATE OBJECT GCL_CONTAINER_2
    EXPORTING
      REPID                       = SY-REPID
      DYNNR                       = SY-DYNNR
      SIDE                        = CL_GUI_DOCKING_CONTAINER=&gt;DOCK_AT_RIGHT
      EXTENSION                   = 1000
    EXCEPTIONS
      CNTL_ERROR                  = 1
      CNTL_SYSTEM_ERROR           = 2
      CREATE_ERROR                = 3
      LIFETIME_ERROR              = 4
      LIFETIME_DYNPRO_DYNPRO_LINK = 5
      OTHERS                      = 6.
  IF SY-SUBRC &lt;&gt; 0.
<font color ="#0000FF">*   MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO</font>
<font color ="#0000FF">*              WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.</font>
  ENDIF.

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form SET_ALV_FIELDCAT2_0100</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM SET_ALV_FIELDCAT2_0100 .

<font color ="#0000FF">*</font>
<font color ="#0000FF">*  PERFORM GET_FIELDCAT_0100     USING     GT_DATA2</font>
<font color ="#0000FF">*                                CHANGING  GT_FCAT.</font>

  PERFORM MAKE_FIELDCAT2_0100.

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form GET_FIELDCAT_0100</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM GET_FIELDCAT_0100  USING    PT_TAB TYPE STANDARD TABLE
                       CHANGING PT_FCAT TYPE LVC_T_FCAT.

  DATA: LO_DREF TYPE REF TO DATA.

  CREATE DATA LO_DREF LIKE PT_TAB.
  FIELD-SYMBOLS &lt;LT_TAB&gt; TYPE TABLE.
  ASSIGN LO_DREF-&gt;* TO &lt;LT_TAB&gt;.

  TRY.
      CALL METHOD CL_SALV_TABLE=&gt;FACTORY
        IMPORTING
          R_SALV_TABLE = DATA(LR_TABLE)
        CHANGING
          T_TABLE      = &lt;LT_TAB&gt;.

    CATCH CX_SALV_MSG. " ALV: General Error Class with Message
  ENDTRY.

  PT_FCAT = CL_SALV_CONTROLLER_METADATA=&gt;GET_LVC_FIELDCATALOG(
              R_COLUMNS      = LR_TABLE-&gt;GET_COLUMNS( )
              R_AGGREGATIONS = LR_TABLE-&gt;GET_AGGREGATIONS( )
            ).

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form MAKE_FIELDCAT2_0100</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM MAKE_FIELDCAT2_0100 .

  GS_LAYOUT-ZEBRA      = 'X'.
  GS_LAYOUT-CWIDTH_OPT = 'A'.
  GS_LAYOUT-SEL_MODE   = 'D'.


<font color ="#0000FF">*  PERFORM SET_FCAT USING :</font>
<font color ="#0000FF">*   'X'   'LEVEL0_TEXT'  '계정과목'   ' '   ' ',</font>
<font color ="#0000FF">*   'X'   'SAKNR'        '계정번호'   'ZEA_SKB1'   'SAKNR',</font>
<font color ="#0000FF">*   ' '   'DMBTR'         ' '          'ZEA_BSEG'   'DMBTR',</font>
<font color ="#0000FF">*   ' '   'D_WAERS'       ' '          'ZEA_BSEG'   'D_WAERS'.</font>

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form DISPLAY_ALV2_0100</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM DISPLAY_ALV2_0100 .


  CALL METHOD GCL_TREE-&gt;SET_TABLE_FOR_FIRST_DISPLAY
    EXPORTING
      I_SAVE          = 'A'
      IS_LAYOUT       = GS_LAYOUT
      IS_VARIANT      = GS_VARIANT
    CHANGING
      IT_OUTTAB       = GT_DATA
      IT_SORT         = GT_SORT
      IT_FIELDCATALOG = GT_FCAT.

  CALL METHOD GCL_TREE-&gt;EXPAND_TREE
    EXPORTING
      I_LEVEL = 1.

  CALL METHOD GCL_TREE-&gt;COLUMN_OPTIMIZE
    EXPORTING
      I_START_COLUMN = GCL_TREE-&gt;C_HIERARCHY_COLUMN_NAME
      I_END_COLUMN   = GCL_TREE-&gt;C_HIERARCHY_COLUMN_NAME.


ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form SET_ALV_LAYOUT2_0100</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM SET_ALV_LAYOUT2_0100 .

  CLEAR GS_LAYOUT.
  CLEAR GS_VARIANT.
  CLEAR GV_SAVE.

  GS_VARIANT-REPORT = SY-REPID.
  GV_SAVE = 'A'.   " '' : Layout 저장불가

<font color ="#0000FF">*  " 'U' : 저장한 사용자만 사용가능</font>
<font color ="#0000FF">*  " 'X' : Layout을 저장하면 모든 사용자가 사용 가능</font>
<font color ="#0000FF">*  " 'A' : Layout을 저장할 때 'U'/'X' 선택 가능</font>
<font color ="#0000FF">*</font>
  GS_LAYOUT-CWIDTH_OPT = 'X'.
  GS_LAYOUT-ZEBRA      = ABAP_ON.
  GS_LAYOUT-SEL_MODE   = 'B'.

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form SET_ALV_EVENT2_0100</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM SET_ALV_EVENT2_0100 .


ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form GET_DATA2</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM GET_DATA2 .

  " Internal Table의 내용을 전부 비워둠
  REFRESH GT_DATA2[].

<font color ="#0000FF">* --B/S 계정 (부채)</font>
  SELECT

  B~GJAHR   " 회계연도
  B~SAKNR   " G/L계정 (Recon)
  D~INDI_CD "차대변 구분자
  C~GLTXT   " G/L계정명
  SUM( B~DMBTR ) AS DMBTR "  통화금액 합계
<font color ="#0000FF">*  SUM( B~EATAX ) AS EATAX " 세금 합계</font>
INTO CORRESPONDING FIELDS OF TABLE GT_DATA2
FROM ZEA_BKPF AS A        " A: 전표 헤더
INNER JOIN ZEA_BSEG AS B   " B: 전표 아이템
  ON A~BUKRS EQ B~BUKRS
 AND A~BELNR EQ B~BELNR
 AND A~GJAHR EQ B~GJAHR
INNER JOIN ZEA_SKB1 AS C   " C: G/L계정마스터
  ON C~BUKRS EQ A~BUKRS
 AND C~SAKNR EQ B~SAKNR
 AND C~GLTXT EQ B~GLTXT
 AND C~XBILK EQ 'X'        " G/L코드 Type - 'X': 대차대조 / '' : 손익계산
INNER JOIN ZEA_TBSL AS D     "D : 전기키 테이블
  ON D~BSCHL EQ B~BSCHL

WHERE C~SAKNR IN R_SAKNR_2   "2로 시작하는 G/L은 부채에 해당
GROUP BY B~GJAHR B~SAKNR D~INDI_CD C~GLTXT .

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form GET_DATA3</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM GET_DATA3 .

  " Internal Table의 내용을 전부 비워둠
  REFRESH GT_DATA3[].

<font color ="#0000FF">* --B/S 계정 (자본)</font>
  SELECT

    B~GJAHR   " 회계연도
    B~SAKNR   " G/L계정 (Recon)
    D~INDI_CD "차대변 구분자
    C~GLTXT   " G/L계정명
    SUM( B~DMBTR ) AS DMBTR "  통화금액 합계
<font color ="#0000FF">*    SUM( B~EATAX ) AS EATAX " 세금 합계</font>
  INTO CORRESPONDING FIELDS OF TABLE GT_DATA3   "자본이력 테이블
  FROM ZEA_BKPF AS A        " A: 전표 헤더
 INNER JOIN ZEA_BSEG AS B   " B: 전표 아이템
    ON A~BUKRS EQ B~BUKRS
   AND A~BELNR EQ B~BELNR
   AND A~GJAHR EQ B~GJAHR
 INNER JOIN ZEA_SKB1 AS C   " C: G/L계정마스터
    ON C~BUKRS EQ A~BUKRS
   AND C~SAKNR EQ B~SAKNR
   AND C~GLTXT EQ B~GLTXT
   AND C~XBILK EQ 'X'        " G/L코드 Type - 'X': 대차대조 / '' : 손익계산
INNER JOIN ZEA_TBSL AS D     "D : 전기키 테이블
    ON D~BSCHL EQ B~BSCHL

  WHERE C~SAKNR IN R_SAKNR_3 "3으로 시작하는 것은 자본
  GROUP BY B~GJAHR B~SAKNR D~INDI_CD C~GLTXT .
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  GS_DATA3-NEW_SAKNR =  '350000'.</font>
<font color ="#0000FF">*  GS_DATA3-T_AMOUNT = LV_INCOME.</font>
<font color ="#0000FF">*  APPEND  GS_DATA3 TO GT_DATA3.</font>

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form CREATE_OBJECT_1</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM CREATE_OBJECT_2 .

<font color ="#0000FF">**-- Create Container (부채)</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  CREATE OBJECT GCL_CONTAINER_2</font>
<font color ="#0000FF">*    EXPORTING</font>
<font color ="#0000FF">*      CONTAINER_NAME = 'CCON1'.        " Name of the Screen CustCtrl Name to Link Container To</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">**-- Create Tree (부채)</font>
<font color ="#0000FF">*  CREATE OBJECT GO_ALV_TREE_1</font>
<font color ="#0000FF">*    EXPORTING</font>
<font color ="#0000FF">*      PARENT              = GO_CONTAINER_1                     " Parent Container</font>
<font color ="#0000FF">*      NODE_SELECTION_MODE = CL_GUI_COLUMN_TREE=&gt;NODE_SEL_MODE_SINGLE. " Nodes: Single or Multiple Selection</font>
<font color ="#0000FF">**      ITEM_SELECTION      = 'X'                                      " Can Individual Items be Selected?</font>
<font color ="#0000FF">**      NO_TOOLBAR          = 'X'                                      " NO_TOOLBAR</font>
<font color ="#0000FF">**      NO_HTML_HEADER      = 'X'.                                   " NO_HTML_HEADER</font>
<font color ="#0000FF">*</font>

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form SET_ALV_FIELDCAT_0100</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM SET_ALV_FIELDCAT_1.
<font color ="#0000FF">*</font>
  PERFORM MAKE_FIELDCAT_1.

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form GT_FCAT</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM GT_FCAT  USING  PT_TAB TYPE STANDARD TABLE
                       CHANGING PT_FCAT TYPE LVC_T_FCAT.

  DATA: LO_DREF TYPE REF TO DATA.

  CREATE DATA LO_DREF LIKE PT_TAB.
  FIELD-SYMBOLS &lt;LT_TAB&gt; TYPE TABLE.
  ASSIGN LO_DREF-&gt;* TO &lt;LT_TAB&gt;.

  TRY.
      CALL METHOD CL_SALV_TABLE=&gt;FACTORY
        IMPORTING
          R_SALV_TABLE = DATA(LR_TABLE)
        CHANGING
          T_TABLE      = &lt;LT_TAB&gt;.

    CATCH CX_SALV_MSG. " ALV: General Error Class with Message
  ENDTRY.

  PT_FCAT = CL_SALV_CONTROLLER_METADATA=&gt;GET_LVC_FIELDCATALOG(
              R_COLUMNS      = LR_TABLE-&gt;GET_COLUMNS( )
              R_AGGREGATIONS = LR_TABLE-&gt;GET_AGGREGATIONS( )
            ).

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form MAKE_FIELDCAT_1</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM MAKE_FIELDCAT_1 .

  GS_LAYOUT-ZEBRA      = 'X'.
  GS_LAYOUT-CWIDTH_OPT = 'A'.
  GS_LAYOUT-SEL_MODE   = 'D'.


<font color ="#0000FF">*  PERFORM SET_FCAT USING :</font>
<font color ="#0000FF">*   'X'   'LEVEL0_TEXT'  '계정과목'   ' '   ' ',</font>
<font color ="#0000FF">*   'X'   'SAKNR'        '계정번호'   'ZEA_SKB1'   'SAKNR',</font>
<font color ="#0000FF">*   ' '   'DMBTR'         ' '          'ZEA_BSEG'   'DMBTR',</font>
<font color ="#0000FF">*   ' '   'D_WAERS'       ' '          'ZEA_BSEG'   'D_WAERS'.</font>

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form SET_ALV_LAYOUT_1</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM SET_ALV_LAYOUT_1 .

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form SET_ALV_EVENT_1</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM SET_ALV_EVENT_1 .
<font color ="#0000FF">* CLEAR GS_LAYOUT.</font>
<font color ="#0000FF">*  CLEAR GS_VARIANT.</font>
<font color ="#0000FF">*  CLEAR GV_SAVE.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  GS_VARIANT-REPORT = SY-REPID.</font>
<font color ="#0000FF">**  GS_VARIANT-VARIANT = PA_LAYO.</font>
<font color ="#0000FF">*  GV_SAVE = 'A'.   " '' : Layout 저장불가</font>
<font color ="#0000FF">*  " 'U' : 저장한 사용자만 사용가능</font>
<font color ="#0000FF">*  " 'X' : Layout을 저장하면 모든 사용자가 사용 가능</font>
<font color ="#0000FF">*  " 'A' : Layout을 저장할 때 'U'/'X' 선택 가능</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  GS_LAYOUT-CWIDTH_OPT = ABAP_ON.</font>
<font color ="#0000FF">*  GS_LAYOUT-ZEBRA      = ABAP_ON.</font>
<font color ="#0000FF">*  GS_LAYOUT-SEL_MODE   = 'D'.</font>
<font color ="#0000FF">**    GS_LAYOUT-SEL_MODE = 'A'.</font>
<font color ="#0000FF">*  " A: 다중 행, 다중 열 선택, 선택 박스 생성</font>
<font color ="#0000FF">*  " (셀 단위, 전체 선택도 가능)</font>
<font color ="#0000FF">**    GS_LAYOUT-SEL_MODE = 'B'. " B : 단일 행, 다중 열 선택, 기본 값</font>
<font color ="#0000FF">*  " 기본값으로 해도 Ctrl + y로 강제로 드래그 할 수는 있음</font>
<font color ="#0000FF">**    GS_LAYOUT-SEL_MODE = 'C'. " C : 다중 행, 다중 열 선택, 줄 단위 선택</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">**  GS_LAYOUT-GRID_TITLE = TEXT-T10.          " ALV TITLE TEXT</font>
<font color ="#0000FF">**  GS_LAYOUT-INFO_FNAME = 'COLOR'.           " 행 색상</font>
<font color ="#0000FF">**  GS_LAYOUT-EXCP_FNAME = 'LIGHT'.           " 신호등</font>
<font color ="#0000FF">**  GS_LAYOUT-EXCP_LED = ABAP_ON.             " 신호등 모양 변경</font>
<font color ="#0000FF">**  GS_LAYOUT-CTAB_FNAME = 'IT_FIELD_COLORS'. " 셀 별 색상</font>
<font color ="#0000FF">**  GS_LAYOUT-STYLEFNAME  = 'STYLE'.          " 스타일</font>
ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form DISPLAY_ALV_1</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM DISPLAY_ALV_1 .


ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form MAKE_HIERARCHY_1</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM MAKE_HIERARCHY_1 .

  GS_HIERARCHY_HEADER-HEADING = '계정과목'.
  GS_HIERARCHY_HEADER-TOOLTIP = '계정과목 폴더'.
  GS_HIERARCHY_HEADER-WIDTH_PIX = ' '.
  GS_HIERARCHY_HEADER-WIDTH = 30.

<font color ="#0000FF">****&---Set Node of 부채-------------------------------------------------*</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  DATA L_GL_TYP TYPE C.</font>
<font color ="#0000FF">*  L_GL_TYP = ZEA_SKB1-SAKNR(2).</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  CASE L_GL_TYP.</font>
<font color ="#0000FF">**    WHEN '10'.</font>
<font color ="#0000FF">**      GV_KEY_2 = 1. " '유동자산'.</font>
<font color ="#0000FF">**</font>
<font color ="#0000FF">**    WHEN '11'.</font>
<font color ="#0000FF">**      GV_KEY_2 = 2. " '비유동자산'.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*    WHEN '21'.</font>
<font color ="#0000FF">*      GV_KEY_2 = 3. " '유동부채'.</font>
<font color ="#0000FF">**</font>
<font color ="#0000FF">**    WHEN '22'.</font>
<font color ="#0000FF">**      GV_KEY_2 = 4. " '비유동부채'.</font>
<font color ="#0000FF">**</font>
<font color ="#0000FF">**    WHEN '31'.</font>
<font color ="#0000FF">**      GV_KEY_2 = 5. " '자본금'.</font>
<font color ="#0000FF">**</font>
<font color ="#0000FF">**    WHEN '33'.</font>
<font color ="#0000FF">**      GV_KEY_2 = 6. " '기타 자본금'.</font>
<font color ="#0000FF">**</font>
<font color ="#0000FF">**    WHEN '35'.</font>
<font color ="#0000FF">**      GV_KEY_2 = 7. " '이익잉여금'.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  ENDCASE.</font>

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form CREATE_OBJECT_2</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM CREATE_OBJECT_RIGHT .

<font color ="#0000FF">*----- Right 컨테이너 생성(부채/자본)용</font>

  CREATE OBJECT GCL_CONTAINER_2
    EXPORTING
      SIDE                        = CL_GUI_DOCKING_CONTAINER=&gt;DOCK_AT_RIGHT
      RATIO                       = 50
    EXCEPTIONS
      CNTL_ERROR                  = 1
      CNTL_SYSTEM_ERROR           = 2
      CREATE_ERROR                = 3
      LIFETIME_ERROR              = 4
      LIFETIME_DYNPRO_DYNPRO_LINK = 5
      OTHERS                      = 6.
  IF SY-SUBRC &lt;&gt; 0.
<font color ="#0000FF">*   MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO</font>
<font color ="#0000FF">*              WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.</font>
  ENDIF.

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form CREATE_HIERARCHY_1</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM Build_node_table. " USING T_NODE LIKE MTREESNODE.

<font color ="#0000FF">**--- Node 추가</font>
<font color ="#0000FF">*  DATA : LS_SKB1 LIKE ZEA_SKB1,</font>
<font color ="#0000FF">*         LT_SKB1 LIKE TABLE OF ZEA_SKB1.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  DATA : NODE LIKE MTREESNODE.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  CLEAR NODE.</font>
<font color ="#0000FF">*  NODE-NODE_KEY = 'Root'.</font>
<font color ="#0000FF">*  NODE-ISFOLDER = 'X'.      "폴더</font>
<font color ="#0000FF">**  NODE-TEXT = '부채'.</font>
<font color ="#0000FF">*  NODE-TEXT = 'SAKNR'.</font>
<font color ="#0000FF">*  APPEND NODE TO GT_NODES.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  CLEAR NODE.</font>
<font color ="#0000FF">*  NODE-NODE_KEY = 'Child1'.</font>
<font color ="#0000FF">*  NODE-RELATKEY = 'Root'.</font>
<font color ="#0000FF">*  NODE-ISFOLDER = 'X'.</font>
<font color ="#0000FF">**  NODE-TEXT = '유동부채'.</font>
<font color ="#0000FF">*  NODE-TEXT = 'BELNR'.</font>
<font color ="#0000FF">*  NODE-EXPANDER = 'X'.</font>
<font color ="#0000FF">*  APPEND NODE TO GT_NODES.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  CLEAR NODE.</font>
<font color ="#0000FF">*  NODE-NODE_KEY = 'Child1'.</font>
<font color ="#0000FF">*  NODE-RELATKEY = 'Root'.</font>
<font color ="#0000FF">*  NODE-ISFOLDER = 'X'.</font>
<font color ="#0000FF">**  NODE-TEXT = '비부채'.</font>
<font color ="#0000FF">*  NODE-TEXT = 'GLTXT'.</font>
<font color ="#0000FF">**  NODE-EXPANDER = ' '.</font>
<font color ="#0000FF">*  NODE-EXPANDER = 'X'.</font>
<font color ="#0000FF">*  APPEND NODE TO GT_NODES.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  CALL METHOD GO_ALV_TREE_1-&gt;ADD_NODES</font>
<font color ="#0000FF">*    EXPORTING</font>
<font color ="#0000FF">*      TABLE_STRUCTURE_NAME = 'ZEA_BSEG'      " Name of Structure of Node Table</font>
<font color ="#0000FF">*      NODE_TABLE           = GT_NODES.       " Node table</font>

<font color ="#0000FF">**********************************************************************</font>
<font color ="#0000FF">******  DATA: LV_DEBT_TYPE_KEY TYPE LVC_NKEY,</font>
<font color ="#0000FF">******        LV_SAKNR_KEY     TYPE LVC_NKEY.</font>
<font color ="#0000FF">******</font>
<font color ="#0000FF">******  " 부채 계정코드 텍스트만 가져와서 LT_NODE에 넣는다.</font>
<font color ="#0000FF">******  SELECT SAKNR, GLTXT</font>
<font color ="#0000FF">******    FROM ZEA_SKB1</font>
<font color ="#0000FF">******   WHERE SAKNR LIKE '2%'</font>
<font color ="#0000FF">******   INTO CORRESPONDING FIELDS OF TABLE @GT_NODE.</font>
<font color ="#0000FF">******</font>
<font color ="#0000FF">******</font>
<font color ="#0000FF">******  LOOP AT GT_NODE INTO GS_NODE.</font>
<font color ="#0000FF">******    " 21~ 유동 22~ 비유동으로 폴더 만드려고</font>
<font color ="#0000FF">******    PERFORM ADD_DEBT_TYPE USING GS_NODE-SAKNR</font>
<font color ="#0000FF">******                                ' '</font>
<font color ="#0000FF">******                          CHANGING LV_DEBT_TYPE_KEY.</font>
<font color ="#0000FF">******</font>
<font color ="#0000FF">******  ENDLOOP.</font>
<font color ="#0000FF">**********************************************************************</font>



<font color ="#0000FF">*  CALL METHOD GO_ALV_TREE_1-&gt;ADD_NODE</font>
<font color ="#0000FF">*    EXPORTING</font>
<font color ="#0000FF">*      I_RELAT_NODE_KEY = GV_KEY_2        " Node Already in Tree Hierarchy</font>
<font color ="#0000FF">*      I_RELATIONSHIP   = CL_GUI_COLUMN_TREE=&gt;RELAT_FIRST_CHILD   " How to Insert Node</font>
<font color ="#0000FF">**     IS_OUTTAB_LINE   =                  " Attributes of Inserted Node</font>
<font color ="#0000FF">**     IS_NODE_LAYOUT   =                  " Node Layout</font>
<font color ="#0000FF">**     IT_ITEM_LAYOUT   =                  " Item Layout</font>
<font color ="#0000FF">*      I_NODE_TEXT      = G_NODE_TEXT_1.    " Hierarchy Node Text</font>
<font color ="#0000FF">**    IMPORTING</font>
<font color ="#0000FF">**      E_NEW_NODE_KEY       =                  " Key of New Node Key</font>
<font color ="#0000FF">**    EXCEPTIONS</font>
<font color ="#0000FF">**      RELAT_NODE_NOT_FOUND = 1                " Relat Node Key not Found</font>
<font color ="#0000FF">**      NODE_NOT_FOUND       = 2                " Node not Found</font>
<font color ="#0000FF">**      OTHERS               = 3.</font>

<font color ="#0000FF">*--- 가공해서 NODE 텍스트를 만든다고 함.</font>

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form ADD_DEBT_TYPE</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">***FORM ADD_DEBT_TYPE USING P_SAKNR      TYPE ZEA_SKB1-SAKNR</font>
<font color ="#0000FF">***                         P_RELATE_KEY TYPE LVC_NKEY</font>
<font color ="#0000FF">***                   CHANGING P_NODE_KEY TYPE LVC_NKEY.</font>
<font color ="#0000FF">***</font>
<font color ="#0000FF">*** DATA: L_NODE_TEXT TYPE LVC_VALUE,</font>
<font color ="#0000FF">***       LS_NODE LIKE LINE OF GT_NODE.</font>
<font color ="#0000FF">***</font>
<font color ="#0000FF">***</font>
<font color ="#0000FF">***</font>
<font color ="#0000FF">***</font>
<font color ="#0000FF">***   CALL METHOD GO_ALV_TREE_1-&gt;ADD_NODE</font>
<font color ="#0000FF">***     EXPORTING</font>
<font color ="#0000FF">***       I_RELAT_NODE_KEY     = P_RELATE_KEY                 " Node Already in Tree Hierarchy</font>
<font color ="#0000FF">***       I_RELATIONSHIP       = CL_GUI_COLUMN_TREE=&gt;RELAT_LAST_CHILD                 " How to Insert Node</font>
<font color ="#0000FF">***       IS_OUTTAB_LINE       = LS_NODE                 " Attributes of Inserted Node</font>
<font color ="#0000FF">****       IS_NODE_LAYOUT       =                  " Node Layout</font>
<font color ="#0000FF">****       IT_ITEM_LAYOUT       =                  " Item Layout</font>
<font color ="#0000FF">***       I_NODE_TEXT          = L_NODE_TEXT                 " Hierarchy Node Text</font>
<font color ="#0000FF">***     IMPORTING</font>
<font color ="#0000FF">***       E_NEW_NODE_KEY       = P_NODE_KEY.                 " Key of New Node Key</font>
<font color ="#0000FF">***</font>
<font color ="#0000FF">***ENDFORM.</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form REFRESH_TREE_DEBT</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM REFRESH_TREE_DEBT .
<font color ="#0000FF">*  DATA : L_SCROLL TYPE LVC_S_STBL.</font>
<font color ="#0000FF">*  L_Scroll-COL = 'X'.</font>
<font color ="#0000FF">*  L_Scroll-ROW = 'X'.</font>
<font color ="#0000FF">*  CALL METHOD GO</font>

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form SET_EVENT_TREE_1</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM SET_EVENT_TREE_1 .
<font color ="#0000FF">*</font>
<font color ="#0000FF">* event-envtid = CL_GUI_SIMPLE_TREE=&gt;EVENTID_NODE_DOUBLE_CLICK.</font>
<font color ="#0000FF">** EVENTS-appl_event = 'X'. "procsee PAI if event occurs</font>
<font color ="#0000FF">* APPEND EVENT TO EVENTS.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  CALL METHOD GO_ALV_TREE_1-&gt;SET_REGISTERED_EVENTS</font>
<font color ="#0000FF">*    EXPORTING</font>
<font color ="#0000FF">*      EVENTS                    =   events      " Event Table</font>
<font color ="#0000FF">*    EXCEPTIONS</font>
<font color ="#0000FF">*      CNTL_ERROR                = 1                " cntl_error</font>
<font color ="#0000FF">*      CNTL_SYSTEM_ERROR         = 2                " cntl_system_error</font>
<font color ="#0000FF">*      ILLEGAL_EVENT_COMBINATION = 3 .               " ILLEGAL_EVENT_COMBINATION</font>


ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form CREATE_SPLIT</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM CREATE_SPLIT .

<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*&      Split 생성</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
  CREATE OBJECT GO_SPLIT
    EXPORTING
      PARENT            = GCL_CONTAINER_2
      ROWS              = 2      " 몇 개의 행으로 나눌 것인지.
      COLUMNS           = 1      " 몇 개의 열로 나눌 것인지.
    EXCEPTIONS
      CNTL_ERROR        = 1
      CNTL_SYSTEM_ERROR = 2
      OTHERS            = 3.
  IF SY-SUBRC &lt;&gt; 0.
<font color ="#0000FF">*   MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO</font>
<font color ="#0000FF">*              WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.</font>
  ENDIF.

<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*&      Split Container에 Container 올리기</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>

  CALL METHOD GO_SPLIT-&gt;GET_CONTAINER
<font color ="#0000FF">*    첫번째 행의 첫번째 열을 go_top과 연결하겠다는 구문</font>
    EXPORTING
      ROW       = 1
      COLUMN    = 1
    RECEIVING
      CONTAINER = GO_TOP. " go_dock2

  CALL METHOD GO_SPLIT-&gt;GET_CONTAINER
<font color ="#0000FF">*    2번쨰 row의 첫번째 열을 GO_BOT과 연결하겠다는 구문</font>
    EXPORTING
      ROW       = 2
      COLUMN    = 1
    RECEIVING
      CONTAINER = GO_BOT.

<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*&       Container 높이 설정</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>

<font color ="#0000FF">*row 높이 설정. (하나의 컨테이너의 높이를 맞추면, 저절로 아래 높이 설정)</font>
  CALL METHOD GO_SPLIT-&gt;SET_ROW_HEIGHT
    EXPORTING
      ID                = 1
      HEIGHT            = 50 " %로 옴.
    EXCEPTIONS
      CNTL_ERROR        = 1
      CNTL_SYSTEM_ERROR = 2
      OTHERS            = 3.
  IF SY-SUBRC &lt;&gt; 0.
<font color ="#0000FF">*   Implement suitable error handling here</font>
  ENDIF.

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form CREATE_TREE</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM CREATE_TREE .

<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*&      1. GCL_TREE_2 (부채 트리 -&gt; GO_TOP과 연결)</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*-- Tree 생성 후 top에 붙이기</font>
  CREATE OBJECT GCL_TREE_2     "부채 Tree 생성
    EXPORTING
      I_PARENT              = GO_TOP
      I_NODE_SELECTION_MODE = CL_GUI_ALV_TREE_SIMPLE=&gt;ALIGN_AT_LEFT
      I_ITEM_SELECTION      = 'X'
      I_NO_HTML_HEADER      = 'X'
      I_NO_TOOLBAR          = ' '.

  GS_VARIANT-REPORT = SY-REPID.


<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*&      2. GCL_TREE_3 (자본 트리 -&gt; GO_BOT과 연결)</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*-- Tree 생성 후 Bottom 에 붙이기</font>
  CREATE OBJECT GCL_TREE_3
    EXPORTING
      I_PARENT              = GO_BOT
      I_NODE_SELECTION_MODE = CL_GUI_ALV_TREE_SIMPLE=&gt;ALIGN_AT_LEFT
      I_ITEM_SELECTION      = 'X'
      I_NO_HTML_HEADER      = 'X'
      I_NO_TOOLBAR          = ' '.

  GS_VARIANT-REPORT = SY-REPID.


ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form DISPLAY_TREE</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM DISPLAY_TREE .

<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*&      1. GCL_TREE_2 (부채 트리/GO_TOP)</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*-- Display 하여 확인하기</font>

  REFRESH GT_SORT.

  GS_VARIANT-REPORT = SY-REPID.
  GS_VARIANT-HANDLE = '2'.

  CALL METHOD GCL_TREE_2-&gt;SET_TABLE_FOR_FIRST_DISPLAY
    EXPORTING
      I_SAVE          = 'A'
      IS_LAYOUT       = GS_LAYOUT2
      IS_VARIANT      = GS_VARIANT
    CHANGING
      IT_OUTTAB       = GT_DISPLAY2     "부채 인터널 테이블과 연결
      IT_SORT         = GT_SORT2
      IT_FIELDCATALOG = GT_FCAT2.

<font color ="#0000FF">*-- Tree 옵션 적용</font>
  CALL METHOD GCL_TREE_2-&gt;EXPAND_TREE
    EXPORTING
      I_LEVEL = 1.

<font color ="#0000FF">*-- Column 열 최적화</font>

  CALL METHOD GCL_TREE_2-&gt;COLUMN_OPTIMIZE
    EXPORTING
      I_START_COLUMN    = GCL_TREE_2-&gt;C_HIERARCHY_COLUMN_NAME                 " First Column to Optimize
      I_END_COLUMN      = GCL_TREE_2-&gt;C_HIERARCHY_COLUMN_NAME                 " Last Column to Optimize
      I_INCLUDE_HEADING = 'X'.                                             " Include Heading

<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*&      2. GCL_TREE_3 (자본 트리/GO_BOT)</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>


  GS_VARIANT-REPORT = SY-REPID.
  GS_VARIANT-HANDLE = '3'.

<font color ="#0000FF">*-- Display 하여 확인하기</font>
  CALL METHOD GCL_TREE_3-&gt;SET_TABLE_FOR_FIRST_DISPLAY
    EXPORTING
      I_SAVE          = 'A'
      IS_LAYOUT       = GS_LAYOUT3
      IS_VARIANT      = GS_VARIANT   "핸들로 구별
    CHANGING
      IT_OUTTAB       = GT_DISPLAY3  "자본 인터널 테이블
      IT_SORT         = GT_SORT3
      IT_FIELDCATALOG = GT_FCAT3.


<font color ="#0000FF">*-- Tree 옵션 적용</font>
  CALL METHOD GCL_TREE_3-&gt;EXPAND_TREE
    EXPORTING
      I_LEVEL = 1.


<font color ="#0000FF">*-- Column 열 최적화</font>

  CALL METHOD GCL_TREE_3-&gt;COLUMN_OPTIMIZE
    EXPORTING
      I_START_COLUMN    = GCL_TREE_3-&gt;C_HIERARCHY_COLUMN_NAME                 " First Column to Optimize
      I_END_COLUMN      = GCL_TREE_3-&gt;C_HIERARCHY_COLUMN_NAME                 " Last Column to Optimize
      I_INCLUDE_HEADING = 'X'.                                             " Include Heading


ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form SET_FACT_2</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM SET_FACT_2 .

<font color ="#0000FF">*-- Set Layout 1,2,3</font>
  PERFORM SET_LAYOUT.

<font color ="#0000FF">*-- Set Field Catalog 1,2,3</font>
  REFRESH GT_FCAT2.
  REFRESH GT_FCAT3.

  PERFORM SET_FCAT
  TABLES GT_FCAT2
  USING :

   ' '   'FLTXT'        '계정과목'        ' '         ' ',
   ' '   'FLTXT2'       '유동/비유동'     ' '         ' ',
   ' '   'GLTXT'        '계정명'     'ZEA_SKB1'    'GLTXT',
   ' '   'SAKNR'        'G/L계정'    'ZEA_SKB1'    'SAKNR',
   ' '   'T_AMOUNT'     'Amount'     'ZEA_BSEG'    'DMBTR',
   ' '   'D_WAERS'      '통화코드'   'ZEA_BSEG'    'D_WAERS'.

  PERFORM SET_FCAT
  TABLES GT_FCAT3
  USING :

   ' '   'FLTXT'        '계정과목'        ' '         ' ',
   ' '   'FLTXT2'       '유동/비유동'     ' '         ' ',
   ' '   'GLTXT'        '계정명'     'ZEA_SKB1'    'GLTXT',
   ' '   'SAKNR'        'G/L계정'    'ZEA_SKB1'    'SAKNR',
   ' '   'T_AMOUNT'     'Amount'     'ZEA_BSEG'    'DMBTR',
   ' '   'D_WAERS'      '통화코드'   'ZEA_BSEG'    'D_WAERS'.

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form MOVE_DISPLAY</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM MOVE_DISPLAY .

  DATA : LT_DATA  TYPE TABLE OF  TS_DISPLAY,
         LS_DATA  TYPE TS_DISPLAY,
         LV_INDEX TYPE SY-TABIX.

  REFRESH GT_DISPLAY1. "인터널 테이블 초기화
  REFRESH LT_DATA. "인터널 테이블 초기화

  "SAKN 별 합계 계산
  LOOP AT GT_DATA INTO GS_DATA.
    CLEAR LS_DATA. "사용하기 전 초기화

    CASE GS_DATA-INDI_CD.
      WHEN 'S'.
        LS_DATA-S_AMOUNT = GS_DATA-DMBTR. "차변 값의 합계
      WHEN 'H'.
        LS_DATA-H_AMOUNT = GS_DATA-DMBTR. "대변 값의 합계
    ENDCASE.


    "SAKNR(계정코드)별 딱 한 값만 저장되도록
    READ TABLE LT_DATA INTO LS_DATA WITH KEY SAKNR = GS_DATA-SAKNR.

    IF SY-SUBRC NE 0.
<font color ="#0000FF">*--- 유동/비유동 구분 후 폴더 노드 값 부여</font>
      IF GS_DATA-SAKNR CP '10*'.
        LS_DATA-FLTXT2  = '유동 자산'.
      ELSE.
        LS_DATA-FLTXT2  = '비유동 자산'.
      ENDIF.
      LS_DATA-FLTXT = '자산'.
<font color ="#0000FF">*--- ----- ---- BP NAME 불러오기</font>
      IF GS_DATA-BPCODE IS NOT INITIAL.
        SELECT SINGLE * FROM ZEA_SKA1 INTO ZEA_SKA1 WHERE BPCODE EQ GS_DATA-BPCODE.
        LS_DATA-GLTXT = GS_DATA-GLTXT && '(파트너:' && ZEA_SKA1-BPNAME && ')'.     "계정명
      ELSE. "BP CODE가 없는 경우
        "자산
        LS_DATA-GLTXT = GS_DATA-GLTXT .     "계정명
      ENDIF.
      LS_DATA-SAKNR = GS_DATA-SAKNR .  "계정번호
      LS_DATA-D_WAERS = 'KRW'.                                "통화코드

<font color ="#0000FF">*----           계정잔액 구하기</font>
      CASE GS_DATA-INDI_CD.
        WHEN 'S'.

          READ TABLE GT_DATA INTO GS_DATA WITH KEY INDI_CD = 'H' SAKNR = LS_DATA-SAKNR.

          IF SY-SUBRC NE 0.
            LS_DATA-T_AMOUNT = LS_DATA-S_AMOUNT.
          ELSE. "대변이 있다면 ?
            LS_DATA-T_AMOUNT = LS_DATA-S_AMOUNT -  GS_DATA-DMBTR.
          ENDIF.
        WHEN 'H'. "지금 돌고있는 GS_DATA는 대변 금액 .

          READ TABLE GT_DATA INTO GS_DATA WITH KEY INDI_CD = 'S' SAKNR = LS_DATA-SAKNR.

          IF SY-SUBRC NE 0. "실패. 한값밖에 없음.
            LS_DATA-T_AMOUNT = LS_DATA-H_AMOUNT.
          ELSE. "차변이 있다면?
            LS_DATA-T_AMOUNT = LS_DATA-H_AMOUNT -  GS_DATA-DMBTR.
          ENDIF.

      ENDCASE.

      APPEND LS_DATA TO LT_DATA.

    ELSE. " 딱 한번만 저장되어야 하기 때문 (S/H -&gt;  T)

    ENDIF.

    MODIFY LT_DATA FROM LS_DATA INDEX  SY-TABIX.

  ENDLOOP.

  APPEND LINES OF LT_DATA TO GT_DISPLAY1.

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form MOVE_DISPLAY2</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM MOVE_DISPLAY2 .

  DATA : LT_DATA  TYPE TABLE OF  TS_DISPLAY,
         LS_DATA  TYPE TS_DISPLAY,
         LV_INDEX TYPE SY-TABIX.

  REFRESH GT_DISPLAY2. "인터널 테이블 초기화
  REFRESH LT_DATA. "인터널 테이블 초기화


  "SAKN 별 합계 계산
  LOOP AT GT_DATA2 INTO GS_DATA2.
    CLEAR LS_DATA. "사용하기 전 초기화

    CASE GS_DATA2-INDI_CD.
      WHEN 'S'.
        LS_DATA-S_AMOUNT = GS_DATA2-DMBTR. "차변 값의 합계
      WHEN 'H'.
        LS_DATA-H_AMOUNT = GS_DATA2-DMBTR. "대변 값의 합계
    ENDCASE.


    "SAKNR(계정코드)별 딱 한 값만 저장되도록
    READ TABLE LT_DATA INTO LS_DATA WITH KEY SAKNR = GS_DATA2-SAKNR.
    IF SY-SUBRC NE 0.
<font color ="#0000FF">*---- 유동/비유동 구분 후 하위 폴더 노드 값 부여</font>

      IF GS_DATA2-SAKNR CP  '22*'.
        LS_DATA-FLTXT2 = '비유동 부채'.
      ELSE.
        LS_DATA-FLTXT2 = '유동 부채'.
      ENDIF.

      LS_DATA-FLTXT = '부채'.                                 "폴더명(상위)
<font color ="#0000FF">*--- ----- ---- BP NAME 불러오기</font>
      IF GS_DATA2-BPCODE IS NOT INITIAL.
        SELECT SINGLE * FROM ZEA_SKA1 INTO ZEA_SKA1 WHERE BPCODE EQ GS_DATA-BPCODE.
        LS_DATA-GLTXT = GS_DATA2-GLTXT && '(파트너:' && ZEA_SKA1-BPNAME && ')'.     "계정명
      ELSE. "BP CODE가 없는 경우
        "자산
        LS_DATA-GLTXT = GS_DATA2-GLTXT .     "계정명
      ENDIF.
      LS_DATA-SAKNR = GS_DATA2-SAKNR.                         "계정번호
      LS_DATA-D_WAERS = 'KRW'.                                "통화코드

<font color ="#0000FF">*----           계정잔액 구하기</font>

      CASE GS_DATA-INDI_CD.

        WHEN 'S'.

          READ TABLE GT_DATA2 INTO GS_DATA2 WITH KEY INDI_CD = 'H' SAKNR = LS_DATA-SAKNR.

          IF SY-SUBRC NE 0.
            LS_DATA-T_AMOUNT = LS_DATA-S_AMOUNT.
          ELSE. "대변이 있다면 ?
            LS_DATA-T_AMOUNT =  GS_DATA2-DMBTR - LS_DATA-S_AMOUNT.
          ENDIF.
        WHEN 'H'. "지금 돌고있는 GS_DATA는 대변 금액 .

          READ TABLE GT_DATA2 INTO GS_DATA2 WITH KEY INDI_CD = 'S' SAKNR = LS_DATA-SAKNR.

          IF SY-SUBRC NE 0. "실패. 한값밖에 없음.
            LS_DATA-T_AMOUNT = LS_DATA-H_AMOUNT.
          ELSE. "차변이 있다면?
            LS_DATA-T_AMOUNT = GS_DATA2-DMBTR - LS_DATA-H_AMOUNT .
          ENDIF.

      ENDCASE.

      APPEND LS_DATA TO LT_DATA.

    ELSE. " 딱 한번만 저장되어야 하기 때문 (S/H -&gt;  T)

    ENDIF.

    MODIFY LT_DATA FROM LS_DATA INDEX  SY-TABIX.

  ENDLOOP.

  APPEND LINES OF LT_DATA TO GT_DISPLAY2.
ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form MOVE_DISPLAY3</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM MOVE_DISPLAY3 .

  DATA : LT_DATA  TYPE TABLE OF  TS_DISPLAY,
         LS_DATA  TYPE TS_DISPLAY,
         LV_INDEX TYPE SY-TABIX.

  REFRESH GT_DISPLAY3. "인터널 테이블 초기화
  REFRESH LT_DATA. "인터널 테이블 초기화


  "SAKN 별 합계 계산
  LOOP AT GT_DATA3 INTO GS_DATA3.
    CLEAR LS_DATA. "사용하기 전 초기화

    CASE GS_DATA3-INDI_CD.
      WHEN 'S'.
        LS_DATA-S_AMOUNT = GS_DATA3-DMBTR. "차변 값의 합계
      WHEN 'H'.
        LS_DATA-H_AMOUNT = GS_DATA3-DMBTR. "대변 값의 합계
    ENDCASE.

    "SAKNR(계정코드)별 딱 한 값만 저장되도록
    READ TABLE LT_DATA INTO LS_DATA WITH KEY SAKNR = GS_DATA3-SAKNR.
    IF SY-SUBRC NE 0.
      LS_DATA-FLTXT = '자본'.                                 "계정폴더(상위)
      LS_DATA-FLTXT2 = '자본금'.                              "계정폴더(하위)
      LS_DATA-GLTXT = GS_DATA3-GLTXT.                         "계정명
      LS_DATA-SAKNR = GS_DATA3-SAKNR.                         "계정번호
      LS_DATA-D_WAERS = 'KRW'.                                "통화코드

<font color ="#0000FF">*----           계정잔액 구하기</font>

      CASE GS_DATA-INDI_CD.

        WHEN 'S'.

          READ TABLE GT_DATA3 INTO GS_DATA3 WITH KEY INDI_CD = 'H' SAKNR = LS_DATA-SAKNR.

          IF SY-SUBRC NE 0.
            LS_DATA-T_AMOUNT = LS_DATA-S_AMOUNT.
          ELSE. "대변이 있다면 ?
            LS_DATA-T_AMOUNT = GS_DATA3-DMBTR - LS_DATA-S_AMOUNT .
          ENDIF.
        WHEN 'H'. "지금 돌고있는 GS_DATA는 대변 금액 .

          READ TABLE GT_DATA3 INTO GS_DATA3 WITH KEY INDI_CD = 'S' SAKNR = LS_DATA-SAKNR.

          IF SY-SUBRC NE 0. "실패. 한값밖에 없음.
            LS_DATA-T_AMOUNT = LS_DATA-H_AMOUNT.
          ELSE. "차변이 있다면?
            LS_DATA-T_AMOUNT =  GS_DATA3-DMBTR - LS_DATA-H_AMOUNT .
          ENDIF.

      ENDCASE.

      APPEND LS_DATA TO LT_DATA.

    ELSE. " 딱 한번만 저장되어야 하기 때문 (S/H -&gt;  T)

    ENDIF.

    MODIFY LT_DATA FROM LS_DATA INDEX  SY-TABIX.

  ENDLOOP.

  APPEND LINES OF LT_DATA TO GT_DISPLAY3.

  GS_DISPLAY3-FLTXT2   = '자본'.  "계정과목 폴더 (상위) - 자산/부채/자본 - 구분
  GS_DISPLAY3-FLTXT = '자본금'. "계정과목 폴더 (하위) - 유동/비유동 구분
  GS_DISPLAY3-GLTXT = '이익잉여금'.
  GS_DISPLAY3-SAKNR =  '350000'.
  GS_DISPLAY3-T_AMOUNT = LV_INCOME.
  GS_DISPLAY3-D_WAERS = 'KRW'.

  APPEND  GS_DISPLAY3 TO GT_DISPLAY3.

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form SET_LAYOUT</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM SET_LAYOUT .

  GS_LAYOUT-ZEBRA      = 'X'.
  GS_LAYOUT-CWIDTH_OPT = 'A'.
  GS_LAYOUT-SEL_MODE   = 'D'.


  GS_LAYOUT2-ZEBRA      = 'X'.
  GS_LAYOUT2-CWIDTH_OPT = 'A'.
  GS_LAYOUT2-SEL_MODE   = 'D'.


  GS_LAYOUT3-ZEBRA      = 'X'.
  GS_LAYOUT3-CWIDTH_OPT = 'A'.
  GS_LAYOUT3-SEL_MODE   = 'D'.


ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form CALL_SAKNR</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM CALL_SAKNR  USING   PV_INDEX_OUTTAB PO_SENDERS PO_GROUPLEVEL .

  CASE  PO_SENDERS.
<font color ="#0000FF">*&------------------자산 Tree</font>
    WHEN GCL_TREE.

      CLEAR GS_DISPLAY1.
<font color ="#0000FF">*--- 더블클릭 값 점검</font>
      READ TABLE GT_DISPLAY1 INTO GS_DISPLAY1 INDEX PV_INDEX_OUTTAB. "선택한 노드를 가져와
      "찾기에 실패했다면 나가고
      IF SY-SUBRC NE 0.
        EXIT.
      ELSE.                                     "찾기에 성공한 경우

        IF PO_GROUPLEVEL NE 'GLTXT'.            "만약 클릭한 것이 'G/L Account'가 아닌 경우
          MESSAGE '상세조회는 계정과목 명을 선택해주세요.' TYPE 'E' DISPLAY LIKE 'S'.
          EXIT.
        ELSE.
          SET PARAMETER ID 'ZEA_SAKNR' FIELD GS_DISPLAY1-SAKNR.
          CALL TRANSACTION 'ZEA_FI040' AND SKIP FIRST SCREEN.
        ENDIF.
      ENDIF.
<font color ="#0000FF">*&------------------부채 Tree</font>
    WHEN GCL_TREE_2.

      CLEAR GS_DISPLAY2.
<font color ="#0000FF">*--- 더블클릭 값 점검</font>
      READ TABLE GT_DISPLAY2 INTO GS_DISPLAY2 INDEX PV_INDEX_OUTTAB. "선택한 노드를 가져와
      "찾기에 실패했다면 나가고
      IF SY-SUBRC NE 0.
        EXIT.
      ELSE.                                     "찾기에 성공한 경우

        IF PO_GROUPLEVEL NE 'GLTXT'.            "만약 클릭한 것이 'G/L Account'가 아닌 경우
          MESSAGE '상세조회는 계정과목 명을 선택해주세요.' TYPE 'E' DISPLAY LIKE 'S'.
          EXIT.
        ELSE.
          SET PARAMETER ID 'ZEA_SAKNR' FIELD GS_DISPLAY2-SAKNR.
          CALL TRANSACTION 'ZEA_FI040' AND SKIP FIRST SCREEN.
        ENDIF.
      ENDIF.
<font color ="#0000FF">*&------------------자본 Tree</font>
    WHEN GCL_TREE_3.

      READ TABLE GT_DISPLAY3 INTO GS_DISPLAY3 INDEX PV_INDEX_OUTTAB. "선택한 노드를 가져와
      "찾기에 실패했다면 나가고
      IF SY-SUBRC NE 0.
        EXIT.
      ELSE.                                     "찾기에 성공한 경우

         IF PO_GROUPLEVEL NE 'GLTXT'.            "만약 클릭한 것이 'G/L Account'가 아닌 경우
          MESSAGE '상세조회는 계정과목 명을 선택해주세요.' TYPE 'E' DISPLAY LIKE 'S'.
          EXIT.

        ELSE.
          IF GS_DISPLAY3-SAKNR EQ  '350000'.
            CALL TRANSACTION 'ZEA_FI090'
            AND SKIP FIRST SCREEN .
          ENDIF.
        ENDIF.
      ENDIF.


  ENDCASE.
ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form SET_HANDLER_TREE</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM SET_HANDLER_TREE .

<font color ="#0000FF">*-- For 자산 Tree</font>

  CREATE OBJECT GCL_HANDLER.

  SET HANDLER :  GCL_HANDLER-&gt;HANDLE_DOUBLE_CLICK FOR GCL_TREE.

  DATA LT_EVENT TYPE CNTL_SIMPLE_EVENTS. "LT
  DATA LS_EVENT LIKE LINE OF LT_EVENT.   "WA


  GCL_TREE-&gt;GET_REGISTERED_EVENTS(
    IMPORTING
      EVENTS     =  LT_EVENT        " simple_events
    EXCEPTIONS
      CNTL_ERROR = 1                " cntl_error
      OTHERS     = 2
  ).
  IF SY-SUBRC &lt;&gt; 0.
    MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
      WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
  ENDIF.

<font color ="#0000FF">*--- Evnet 추가</font>
  LS_EVENT-EVENTID = CL_GUI_SIMPLE_TREE=&gt;EVENTID_NODE_DOUBLE_CLICK.
  LS_EVENT-APPL_EVENT = 'X'.
  APPEND LS_EVENT TO LT_EVENT.

  GCL_TREE-&gt;SET_REGISTERED_EVENTS(
    EXPORTING
      EVENTS                    =  LT_EVENT  " Event Table
    EXCEPTIONS
      CNTL_ERROR                = 1                " cntl_error
      CNTL_SYSTEM_ERROR         = 2                " cntl_system_error
      ILLEGAL_EVENT_COMBINATION = 3                " ILLEGAL_EVENT_COMBINATION
      OTHERS                    = 4
  ).
  IF SY-SUBRC &lt;&gt; 0.
    MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
      WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
  ENDIF.

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form SET_HANDLER_TREE2</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM SET_HANDLER_TREE2 .

<font color ="#0000FF">*-- For 자산 Tree</font>

  SET HANDLER :  GCL_HANDLER-&gt;HANDLE_DOUBLE_CLICK FOR GCL_TREE_2.
<font color ="#0000FF">*  SET HANDLER :  GCL_HANDLER-&gt;HANDLE_DOUBLE_CLICK FOR GCL_TREE_3.</font>

  DATA LT_EVENT TYPE CNTL_SIMPLE_EVENTS. "LT
  DATA LS_EVENT LIKE LINE OF LT_EVENT.   "WA

  GCL_TREE_2-&gt;GET_REGISTERED_EVENTS(
    IMPORTING
      EVENTS     =  LT_EVENT        " simple_events
    EXCEPTIONS
      CNTL_ERROR = 1                " cntl_error
      OTHERS     = 2
  ).

  IF SY-SUBRC &lt;&gt; 0.
    MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
      WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
  ENDIF.

<font color ="#0000FF">*--- Evnet 추가</font>
  LS_EVENT-EVENTID = CL_GUI_SIMPLE_TREE=&gt;EVENTID_NODE_DOUBLE_CLICK.
  LS_EVENT-APPL_EVENT = 'X'.
  APPEND LS_EVENT TO LT_EVENT.

  GCL_TREE_2-&gt;SET_REGISTERED_EVENTS(
    EXPORTING
      EVENTS                    =  LT_EVENT  " Event Table
    EXCEPTIONS
      CNTL_ERROR                = 1                " cntl_error
      CNTL_SYSTEM_ERROR         = 2                " cntl_system_error
      ILLEGAL_EVENT_COMBINATION = 3                " ILLEGAL_EVENT_COMBINATION
      OTHERS                    = 4
  ).
  IF SY-SUBRC &lt;&gt; 0.
    MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
      WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
  ENDIF.

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form SET_HANDLER_TREE3</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM SET_HANDLER_TREE3 .

  SET HANDLER :  GCL_HANDLER-&gt;HANDLE_DOUBLE_CLICK FOR GCL_TREE_3.

  DATA LT_EVENT TYPE CNTL_SIMPLE_EVENTS. "LT
  DATA LS_EVENT LIKE LINE OF LT_EVENT.   "WA

  GCL_TREE_3-&gt;GET_REGISTERED_EVENTS(
    IMPORTING
      EVENTS     =  LT_EVENT        " simple_events
    EXCEPTIONS
      CNTL_ERROR = 1                " cntl_error
      OTHERS     = 2
  ).

  IF SY-SUBRC &lt;&gt; 0.
    MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
      WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
  ENDIF.

<font color ="#0000FF">*--- Evnet 추가</font>
  LS_EVENT-EVENTID = CL_GUI_SIMPLE_TREE=&gt;EVENTID_NODE_DOUBLE_CLICK.
  LS_EVENT-APPL_EVENT = 'X'.
  APPEND LS_EVENT TO LT_EVENT.

  GCL_TREE_3-&gt;SET_REGISTERED_EVENTS(
    EXPORTING
      EVENTS                    =  LT_EVENT  " Event Table
    EXCEPTIONS
      CNTL_ERROR                = 1                " cntl_error
      CNTL_SYSTEM_ERROR         = 2                " cntl_system_error
      ILLEGAL_EVENT_COMBINATION = 3                " ILLEGAL_EVENT_COMBINATION
      OTHERS                    = 4
  ).
  IF SY-SUBRC &lt;&gt; 0.
    MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
      WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
  ENDIF.

ENDFORM.
</pre>
<hr>
<font size="2" face = "Sans Serif">Extracted by Direct Download Enterprise version 1.3.1 - E.G.Mellodew. 1998-2005 UK. Sap Release 754
</font>
</body>
</html>
